<div class="admin-loan-payment-container">
  <h3>Admin Loan Payment</h3>

  <!-- ✅ Messages -->
  <div *ngIf="paymentError" class="error-message">{{ paymentError }}</div>
  <div *ngIf="paymentSuccess" class="success-message">✅ Admin payment successful!</div>

  <!-- ✅ No Loans -->
  <div *ngIf="approvedLoans.length === 0 && !paymentError">
    <p>No approved loans available in this chama.</p>
  </div>

  <!-- ✅ Loans Available -->
  <div *ngIf="approvedLoans.length > 0">
    <label for="loan">Select Loan:</label>
    <select
      [(ngModel)]="selectedLoan"
      name="loan"
      id="loan"
      (change)="onLoanSelected()"
    >
      <option [ngValue]="null">-- Select Loan --</option>
      <option *ngFor="let loan of approvedLoans" [ngValue]="loan">
        {{ loan.fullName }} - {{ loan.amount | currency }}
      </option>
    </select>

    <!-- ✅ Payment History -->
    <div *ngIf="selectedLoan">
      <h4>Payment History</h4>

      <div *ngIf="loadingHistory" class="loading">Loading history...</div>

      <table *ngIf="paymentHistory.length > 0">
        <thead>
          <tr>
            <th>Date</th>
            <th>Amount Paid</th>
            <th>By Admin?</th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let p of paymentHistory">
            <td>{{ p.paymentDate | date:'short' }}</td>
            <td>{{ p.amountPaid | currency }}</td>
            <td>{{ p.paidByAdmin ? 'Yes' : 'No' }}</td>
          </tr>
        </tbody>
      </table>

      <div *ngIf="paymentHistory.length === 0 && !loadingHistory" class="empty">
        No payments have been made yet.
      </div>
    </div>

    <br />

    <!-- ✅ Payment Input -->
    <label for="amount">Amount to Pay:</label>
    <input type="number" [(ngModel)]="amountPaid" id="amount" />

    <br /><br />

    <button (click)="makeAdminPayment()">Pay Manually</button>
  </div>
</div>
